# Проект: Предсказание оттока клиентов оператора связи «ТелеДом»

## Описание проекта

Оператор связи **«ТелеДом»** стремится снизить отток клиентов, предлагая промокоды и специальные условия тем, кто планирует разорвать договор. Для эффективного удержания клиентов необходима модель, способная предсказывать вероятность оттока.

### Цель проекта:
Разработать модель машинного обучения для предсказания оттока клиентов.

### Целевая метрика:
- **ROC-AUC ≥ 0.85** (важна не только точность, но и способность различать классы).

## Содержание

1. Загрузка данных  
2. Предварительный исследовательский анализ (EDA)  
3. Предобработка данных  
4. Объединение таблиц  
5. Анализ объединённого датафрейма  
6. Подготовка данных к моделированию  
7. Обучение моделей  
8. Оценка и выбор лучшей модели  
9. Выводы и рекомендации

## Этапы проекта

### 1. Загрузка данных
- Импорт файлов: `contract_new.csv`, `personal_new.csv`, `internet_new.csv`, `phone_new.csv`.
- Проверка типов данных и пропусков.

### 2. Предварительный исследовательский анализ (EDA)
- Изучение каждого датафрейма по отдельности.
- Оценка значимости признаков.
- Выявление аномалий.

### 3. Предобработка данных
- Обработка пропусков (`no_use`).
- Преобразование типов данных.
- Кодирование категориальных признаков.

### 4. Объединение таблиц
- Слияние по ключу `customerID` в единый датафрейм.

### 5. Анализ объединённого датафрейма
- Анализ распределений.
- Корреляционный анализ.
- Визуализация.
- Создание новых признаков:
  - `service_day` — длительность пользования услугами.
  - `additional_service` — количество дополнительных подключённых услуг.

### 6. Подготовка данных к моделированию
- Масштабирование признаков.
- Кодирование категорий.
- Разделение данных на обучающую и тестовую выборки.

### 7. Обучение моделей
- Модель CatBoost с подбором гиперпараметров (`learning_rate=0.2`, `depth=4`).
- Сравнение с другими моделями.

### 8. Оценка и выбор лучшей модели
- ROC AUC на кросс-валидации: **0.91**.
- ROC AUC на тестовой выборке: **0.93**.
- Модель успешно различает классы, приближаясь к идеальной.

### Визуализация результатов
- **ROC-кривая** близка к верхнему левому углу — модель хорошо определяет вероятность оттока.
- **Матрица ошибок**: ложноотрицательных меньше, чем ложноположительных, но именно ложноотрицательные — критичные для бизнеса.

## Выводы

- Создана надёжная модель для предсказания оттока клиентов.
- Признак `service_day` оказался одним из ключевых.
- Влияние на отток:
  - Долгий срок обслуживания — выше риск ухода.
  - Наличие партнёра увеличивает вероятность оттока.
  - Тип подключения (Fiber Optic) связан с более высоким оттоком.
  - Большее количество дополнительных услуг также повышает риск ухода.
  - Автоматическая оплата и высокая сумма ежемесячных платежей — дополнительные факторы риска.

## Рекомендации

### 1. Удержание лояльных клиентов
- Использовать признак `service_day` для персонализированных предложений.
- Внедрить программы лояльности для старых клиентов.

### 2. Работа с клиентами с несколькими услугами
- Предлагать расширенные пакеты и бонусы.
- Повышать прозрачность стоимости услуг.

### 3. Оптимизация оплаты
- Улучшить систему управления автоматическими платежами.
- Ввести уведомления и гибкие настройки списаний.

### 4. Персонализированные предложения
- Использовать модель оттока для формирования индивидуальных акций.
- Настроить таргетированные уведомления с учётом профиля клиента.

---

Итог: Разработанная модель поможет компании «ТелеДом» эффективно работать с клиентами и снижать уровень оттока.
