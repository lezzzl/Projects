# Прогнозирование продуктивности коров для фермы «Вольный луг»

## Цель проекта
Фермер хочет отобрать коров, которые соответствуют двум ключевым критериям:
1. **Средний удой за год** — не менее **6000 кг**.
2. **Вкус молока** — соответствует строгим критериям качества фермера.

Для достижения этой цели:
- Разработать две модели машинного обучения:
  1. Прогнозирование возможного удоя коровы (целевой признак: **Удой, кг**).
  2. Определение вероятности получения вкусного молока (целевой признак: **Вкус молока**).
- Применить модели для отбора коров из предоставленного списка «ЭкоФермы».

---

## Датасеты и описание данных

### 1. **`ferma_main.csv`** — текущее стадо фермера
- Характеристики коровы:
  - `id` — уникальный идентификатор коровы.
  - `Порода` — порода коровы.
  - `порода папы_быка` — порода отца коровы.
  - `Возраст` — возраст коровы (категории: менее_2_лет, более_2_лет).
- Характеристики корма:
  - `ЭКЕ` (энергетическая кормовая единица) — питательность корма.
  - `Сырой протеин, г` — содержание сырого протеина в корме.
  - `СПО` (сахаро-протеиновое соотношение) — отношение сахара к протеину.
- Характеристика пастбища:
  - `Тип пастбища` — ландшафт лугов, на которых паслась корова.
- Характеристики молока:
  - `Удой, кг` — масса молока за год (целевой признак для первой модели).
  - `Жирность, %` — содержание жиров в молоке.
  - `Белок, %` — содержание белков в молоке.
  - `Вкус молока` — бинарный признак (целевой признак для второй модели).

### 2. **`ferma_dad.csv`** — данные об отцах коров
- `id` — уникальный идентификатор коровы.
- `Имя Папы` — имя отца коровы.

### 3. **`cow_buy.csv`** — коровы из «ЭкоФермы» (кандидаты для покупки)
- Характеристики коровы:
  - `Порода` — порода коровы.
  - `Тип пастбища` — ландшафт лугов, на которых паслась корова.
  - `порода папы_быка` — порода отца коровы.
  - `Имя_папы` — имя отца коровы.
  - `Возраст` — возраст коровы (категории: менее_2_лет, более_2_лет).
- Характеристики молока:
  - `Текущая_жирность, %` — содержание жиров в молоке.
  - `Текущий_уровень_белок, %` — содержание белков в молоке.
- Особенности:
  - **Целевые признаки отсутствуют** (`Удой, кг`, `Вкус молока`).
  - Параметры корма отсутствуют, но будут увеличены на 5% для новых коров.

---

## План выполнения проекта

### Шаг 1. Загрузка и первичный анализ данных
- Загрузка всех трех датасетов.
- Анализ структуры данных:
  - Проверка типов данных и пропусков.
  - Обзор статистических характеристик.

### Шаг 2. Подготовка данных
1. Приведение столбцов к удобному формату:
   - Приведение названий столбцов к нижнему регистру.
   - Замена категориальных признаков (например, `Возраст`) на числовые или кодирование.
2. Обработка пропусков:
   - Анализ пропусков в каждом датасете.
   - Замена или удаление значений с обоснованием.
3. Дополнение данных:
   - Добавление информации о «папах» коров из `ferma_dad.csv` в основной датасет.
   - Увеличение параметров корма в `cow_buy.csv` на 5%.
4. Разделение данных:
   - Целевые признаки: `Удой, кг` и `Вкус молока`.
   - Остальные признаки — для построения моделей.

### Шаг 3. Исследовательский анализ данных
- Анализ корреляций между признаками.
- Визуализация ключевых характеристик (например, удоя и вкуса молока).
- Выявление значимых факторов, влияющих на удой и вкус молока.
### Шаг 4. Проведите корреляционный анализ признаков в датасете ferma_main.csv
### Шаг 5. Построение моделей
1. **Первая модель:** Прогнозирование удоя (`Удой, кг`).
   - Подбор регрессионных алгоритмов (например, линейная регрессия, случайный лес).
   - Оценка метрик: MAE, RMSE, R².
2. **Вторая модель:** Прогнозирование вкуса молока (`Вкус молока`).
   - Подбор классификационных алгоритмов (например, логистическая регрессия, градиентный бустинг).
   - Оценка метрик: Accuracy, Precision, Recall, F1-score.
   - Регулировка порога для оптимизации ошибок I и II рода.

### Шаг 6. Прогноз для «ЭкоФермы»
- Применение обученных моделей к данным из `cow_buy.csv`.
- Отбор коров, соответствующих критериям фермера:
  - **Удой ≥ 6000 кг.**
  - **Вероятность вкуса молока ≥ заданного порога.**

### Шаг 7. Общий вывод
- Заключение о выявленных закономерностях.
- Рекомендации фермеру по выбору коров.
