# Проект: Классификация токсичных комментариев для «Викишоп»

## Описание проекта

Интернет-магазин **«Викишоп»** запускает сервис, позволяющий пользователям редактировать и дополнять описания товаров. Пользователи оставляют комментарии к правкам, поэтому требуется инструмент для поиска токсичных сообщений и отправки их на модерацию.

Цель проекта — обучить модель классифицировать комментарии на позитивные и негативные (токсичные), чтобы обеспечить автоматическую фильтрацию нежелательного контента.

## Цель проекта

- Построить модель классификации комментариев по признаку токсичности.
- Достичь значения метрики **F1 не ниже 0.75**.

## Описание данных

Датасет: `toxic_comments.csv`  
Признаки:
- `text` — текст комментария
- `toxic` — целевой признак (0 — нетоксичный, 1 — токсичный)

## Этапы выполнения проекта

1. Загрузка и подготовка данных
2. Анализ данных
3. Подготовка признаков для моделей
4. Обучение и сравнение моделей
5. Подбор гиперпараметров
6. Оценка финальной модели
7. Выводы и рекомендации

## Результаты

### 1. Загрузка и подготовка данных
- Данные успешно загружены.
- Проведена очистка текста:
  - Приведение к нижнему регистру.
  - Удаление спецсимволов с помощью регулярных выражений.
  
### 2. Анализ данных
- Обнаружен значительный дисбаланс классов (токсичных сообщений меньше).
- Построены облака слов:
  - Токсичные комментарии содержат оскорбления: "fucking", "stupid", "idiot".
  - Нетоксичные комментарии включают конструктивные фразы, связанные с редактированием.

### 3. Модели и обучение
- Обучены разные модели классификации.
- Лучшая из базовых моделей — **Random Forest**.
- Базовое значение F1 на кросс-валидации: **0.9126**.

### 4. Подбор гиперпараметров
- Для Random Forest выполнен подбор гиперпараметров с помощью RandomizedSearchCV.
- После оптимизации метрика F1 улучшилась до **0.9218** на кросс-валидации.

### 5. Оценка финальной модели
- Тестирование на отдельной тестовой выборке показало высокую эффективность:
  - **F1-score = 0.9935**.
- Модель уверенно классифицирует токсичные и нетоксичные комментарии.

## Выводы

- Поставленная задача успешно решена.
- Достигнуто качество выше требуемого порога (F1 > 0.75).
- Финальная модель Random Forest со сбалансированными параметрами показала отличный результат на тестовой выборке.
- Рекомендация: использовать данную модель в качестве инструмента для автоматической модерации комментариев.

## Возможные улучшения
- Попробовать дообучение модели BERT для дальнейшего повышения качества.
- Реализовать автообновление модели при накоплении новых размеченных данных.

